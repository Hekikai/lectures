В современных сайтах скрипты обычно довольно тяжелые: много весят, долго обрабатываются.
А как мы знаем из [[DOMContentLoaded, load, beforeunload, unload]], то скрипт в своей очереди "блокируют" все элементы, которые после него. То есть сначала должен загрузиться скрипт, а только потом может начать грузится то, что ниже. Также работает и с DOM.

Сначала скрипты - потом продолжает генерироваться DOM.

Ну первый - самый известный обход этой ситуации - помещать скрипты перед закрывающим тегом `body`. Но тут палка о двух концах: если HTML очень-очень большой, то скрипт начнется грузиться довольно поздно.

Такие вещи незаметны людям, у кого очень быстрое соединение, но много кто в мире имеет медленное подключение к интернету или использует не такой хороший мобильный интернет.

К счастью, разработчики придумали два атрибута для наших скриптов: `async` и `defer`.

**defer**

Атрибут `defer` сообщает браузеру, что он должен грузить скрипт в фоновом режиме и дальше обрабатывать страницу, но запустить этот скрипт сразу же, когда DOM-дерево будет полностью построено.

- скрипты с `defer` никогда не блокируют страницу.
- скрипты с `defer` всегда выполнятся, когда DOM-дерево готово, но до события `DOMContentLoaded`.

Отложенные с помощью `defer` скрипты сохраняют порядок относительно друг друга, как и обычные скрипты.

Поэтому, если сначала загружается большой скрипт, а затем меньшего размера, то последний будет ждать.

Атрибут `defer` будет проигнорирован, если в теге `<script>` нет `src`.

**async**

Этот атрибут скрипта означает, что скрипт полностью независим:
- он не ждет (скрипт с `async`) других скриптов.
- он не ждет события `DOMContentLoaded`; так что они могут начаться в разнобой.
- сама страница не ждет асинхронных скриптов, так что она обрабатывается дальше.
- кто первый загрузится - тот первый и запустится.

Так что если у нас есть несколько скриптов с `async`, они могут выполняться в любом порядке. То, что первое загрузится – запустится в первую очередь.

Асинхронные скрипты очень полезны для добавления на страницу сторонних скриптов: счётчиков, рекламы и т.д. Они не зависят от наших скриптов, и мы тоже не должны ждать их:
```html
<!-- Типичное подключение скрипта Google Analytics -->
<script async src="https://google-analytics.com/analytics.js"></script>
```

**Динамически загружаемые скрипты**

Мы можем добавить скрипт прям из JS. Он начнет загружаться, как только он будет добавлен. Динамически загружаемые скрипты ведут себя как `async`. Мы можем изменить относительный порядок скриптов с «первый загрузился – первый выполнился» на порядок, в котором они идут в документе (как в обычных скриптах) с помощью явной установки свойства `async` в `false`.

На практике `defer` используется для скриптов, которым требуется доступ ко всему DOM и/или важен их относительный порядок выполнения.

А `async` хорош для независимых скриптов, например счётчиков и рекламы, относительный порядок выполнения которых не играет роли.